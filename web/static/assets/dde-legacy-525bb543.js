System.register(["./toasts-legacy-14f1e720.js","./index-legacy-a3ed4133.js","./his_date-legacy-0bc670a8.js"],(function(e,a){"use strict";var t,r,n,i,o,s,l,u;return{setters:[e=>{t=e.t,r=e.a},e=>{n=e.r,i=e.aC,o=e.ap,s=e.aN,l=e.ao},e=>{u=e.t}],execute:function(){e({a:async function(e){var r;if(d.value)return g(await a.findByNpid(e));const n=await s.searchByNpid(e);return n.ok?n.data:(t(null!==(r=n.errorMessage)&&void 0!==r?r:`Searching client by NPID returned error: ${n.clientErrorType}`),[])},b:async function(e){var r;if(d.value)return g(await a.findByDemographics(e));const n=await s.searchBy(e);return n.ok?n.data:(t(null!==(r=n.errorMessage)&&void 0!==r?r:`Searching client by Demographics returned error: ${n.clientErrorType}`),[])},g:v,h:async function(e){var r;const n=await a.getLocalAndRemoteDiffs(e);if(n.ok){const{local:e,remote:a}=n.data.diff.npid;return console.log("Local and remote npid",e,a),e!==a}t(null!==(r=n.errorMessage)&&void 0!==r?r:`Unable to get diffs because ${n.clientErrorType}`)},i:async function(e){var n;if(!(await l("Are you sure you want to import client?")))return;const i=await a.importPatient(e);if(i.ok)return r("Client imported to local database"),i.data;t(null!==(n=i.errorMessage)&&void 0!==n?n:`Error importing with error: ${i.clientErrorType}`)},r:async function(){d.value=await a.isDDeEnabled(),d.value&&await v()},s:async function(e){const n=await(e?a.enableDDe():a.disableDDe());var i;n.ok?(d.value=e,r("DDE status updated")):t(null!==(i=n.errorMessage)&&void 0!==i?i:`Unable to change status because ${n.clientErrorType}`)}});const a=new i(o),d=e("d",n(!1)),c=e("n",n([]));function p(e){return e.patient_identifiers.reduce(((e,a)=>({...e,[a.type.name]:a.identifier})),{})["DDE person document ID"]}async function v(){const e=await a.getRemainingNpids();if(e.ok&&e.data){var r,n,i;const a=e.data.npid_status[0],t=null!==(r=a.unassigned)&&void 0!==r?r:0,o=null!==(n=a.avg_consumption_rate_per_day)&&void 0!==n?n:0,s=Math.floor(t/(o||1)),l=u(a.date_last_updated);c.value=[{label:"Assigned",value:null!==(i=a.assigned)&&void 0!==i?i:0},{label:"Unassigned",value:t},{label:"Average consumption per day",value:o},{label:"Estimated days left",value:s},{label:"Last Updated",value:l}],console.log("Npid status refreshed",c.value)}else{var o;t(null!==(o=e.errorMessage)&&void 0!==o?o:`Unable to get NPID status because ${e.clientErrorType}`)}}function g(e){var a;return e.ok&&e.data?Object.keys(e.data).reduce(((a,t)=>[...a,...e.data[t].map((e=>({...e,source:t,docID:p(e),ddeClientRequiresImport:p(e)&&"remotes"===t&&!e.patient_id})))]),[]):(t(null!==(a=e.errorMessage)&&void 0!==a?a:`An error happened with status code: ${e.httpStatusResponse}`),[])}}}}));
