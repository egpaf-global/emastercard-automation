var p=Object.defineProperty;var l=(n,a,e)=>a in n?p(n,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[a]=e;var i=(n,a,e)=>(l(n,typeof a!="symbol"?a+"":a,e),e);import{g as c}from"./common-abc2f84d.js";import{R as _}from"./report_service-d8ac4aa7.js";import{A as d}from"./age_groups-8203d13f.js";const h=["Died","IIT <3 mo","IIT 3-5 mo","IIT 6+ mo","Transferred out","Refused (Stopped)"],w={tx_curr:"TX_CURR",symptom_screen_alone:"Symptom Screen (alone)",cxr_screen:"CXR Screen",mwrd_screen:"mWRD Screen",sceen_pos_new:"New on ART/Screen Positive",sceen_neg_new:"New on ART/Screen Negative",sceen_pos_prev:"Already on ART/Screen Positive",sceen_neg_prev:"Already on ART/Screen Negative",started_tb_new:"Started TB RX_New on ART",started_tb_prev:"Started TB RX_Prev on ART"},u={less_than_three_months:"# of clients on <3 months of ARVs",three_to_five_months:"# of clients on 3 - 5 months of ARVs",greater_than_six_months:"# of clients on >= 6 months of ARVs"},A={tx_curr:"TX_CURR",ever_diagnosed_htn:"Ever diagnosed with HTN",screened_for_htn:"Screened for HTN",newly_diagnosed_htn:"Newly diagnosed with HTN",controlled_htn:"Controlled HTN"};class f extends _{constructor(){super();i(this,"reportType");i(this,"initialize");this.reportType="pepfar",this.initialize=!0}setReportType(e){this.reportType=e}setInitialize(e){this.initialize=e}async getTxCurrMMDReport(e=!1){const t=await this.getReport("programs/".concat(this.programId,"/reports/tx_curr_mmd"),{definition:this.reportType,rebuild:e});if(!t)return[];const r=this.txMmdReportBuilder(t),o=await this.buildMaternityAgreggateRows(r.F.aggregate);return[...r.F.rows,...r.M.rows,{ageGroup:"All",gender:"M",...r.M.aggregate},...o]}async getTxMlReport(e){const t=await this.getReport("tx_ml",{rebuild:e});if(!t)return[];const r=this.txMlReportBuilder(t),o=await this.buildMaternityAgreggateRows(r.F.aggregate);return[...r.F.rows,...r.M.rows,{ageGroup:"All",gender:"M",...r.M.aggregate},...o]}getTxRttReport(e){return this.getReport("tx_rtt",{rebuild:e})}getClinicTxRtt(e){return this.getReport("programs/".concat(this.programId,"/reports/clinic_tx_rtt"),{rebuild:e})}async getTxTbReport(e){return this.getReport("programs/".concat(this.programId,"/reports/tx_tb"),{rebuild_outcome:e})}getTxNewReport(e){return this.getReport("programs/".concat(this.programId,"/reports/tx_new"),{rebuild:e})}async getTxHivHtnReport(e){const t=await this.getReport("programs/".concat(this.programId,"/reports/tx_hiv_htn"),{rebuild:e}),r=Object.entries(t).reduce((o,[s,g])=>(/Unknown|All/i.test(s)||(o.M.push({ageGroup:s,gender:"Male",...g.M}),o.F.push({ageGroup:s,gender:"Female",...g.F})),o),{M:[],F:[]});return[...r.F,...r.M,{ageGroup:"All",gender:"Male",...t.All.Male},{ageGroup:"All",gender:"FP",...t.All.FP},{ageGroup:"All",gender:"FNP",...t.All.FNP},{ageGroup:"All",gender:"FBf",...t.All.FBf}]}mapTxMlIndcators(e){return h.reduce((t,r,o)=>{var s;return t[r]=(s=e[o])!=null?s:[],t},{})}txMlReportBuilder(e){const t={M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}};return d.forEach(r=>{["F","M"].forEach(o=>{const s=this.mapTxMlIndcators(c(e,"".concat(r,".").concat(o),[]));t[o].rows.push({ageGroup:r,gender:o,...s}),this.aggregateIndicatorData(t,s,o)})}),t}aggregateIndicatorData(e,t,r){Object.entries(t).forEach(([o,s])=>{var g;e[r].aggregate[o]=[...s,...(g=e[r].aggregate[o])!=null?g:[]]})}txMmdReportBuilder(e){return Object.keys(e).reduce((t,r)=>{if(!/Unknown/i.test(r)){const o=c(e,"".concat(r,".Female"));t.F.rows.push({ageGroup:r,gender:"F",...o}),this.aggregateIndicatorData(t,o,"F");const s=c(e,"".concat(r,".Male"));t.M.rows.push({ageGroup:r,gender:"M",...s}),this.aggregateIndicatorData(t,s,"M")}return t},{M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}})}}export{u as T,f as a,h as b,w as c,A as d};
