import{d as T,r as I,f as b,g as B,h as E,i as M,j as z,w as s,u as e,k as N,o as w,e as a,l as S,m as q,n as v,p as D,b as n,q as K,t as p,a as l,s as U,v as G,x as f,I as C,y as L,z as j,c as H,A as W,B as P,C as x,D as J,E as O,F as Q,G as X,H as Y,_ as Z}from"./index-2ad1f2cc.js";import{r as g}from"./image-cb93bc3e.js";import{t as _}from"./toasts-4c6a636f.js";import{u as $}from"./PasswordUpdate-d43261b2.js";import"./TextInput-1b9f7d94.js";import"./his_date-d43cc0fa.js";import"./form-9d7f0797.js";import"./Strs-0c962638.js";import"./common-abc2f84d.js";import"./loader-0a050b3f.js";const ee=["src"],oe=["src"],ae=["src"],se={key:0},te=T({__name:"login",setup(le){const r=I(""),t=I(""),y=b(),i=$(),{fullVersion:k}=X(),{facility:u,loadFacilityCode:V,loadCurrentFacility:h}=N(),{initiateIdleTimer:A,stopIdleTimer:F}=B(),R=E(()=>y.currentRoute.value.redirectedFrom);M(()=>{F(),h(!0)});const d=async()=>{var m;try{if(!r.value||!t.value)return _("Invalid login details");const o=await Y.login(r.value,t.value);o.ok?(i.setCurrentPassword(t.value),await i.canChangePassword()&&await i.changePasswaord(),V(),A(),y.push((m=R.value)!=null?m:"/")):_(o.errorMessage)}catch(o){_("An error occurred while logging in"),console.error(o)}};return(m,o)=>(w(),z(e(Q),null,{default:s(()=>[a(e(O),null,{default:s(()=>[a(e(S),{style:{margin:"0",padding:"0"}},{default:s(()=>[a(e(q),null,{default:s(()=>[a(e(v),{size:"8"},{default:s(()=>[a(e(D),{class:"title"},{default:s(()=>o[2]||(o[2]=[n("E-MASTERCARD APP")])),_:1}),a(e(K),{class:"sub-title"},{default:s(()=>[n(p(e(k)),1)]),_:1}),l("img",{src:e(g)("report.png"),class:"hero-image"},null,8,ee),a(e(U),{class:"footer-section"},{default:s(()=>[a(e(G),null,{default:s(()=>[l("span",null,[l("img",{id:"coat",src:e(g)("login-logos/Malawi-Coat_of_arms_of_arms.png"),alt:"Malawi Coat of Arms logo",class:"brand-logo-moh"},null,8,oe),l("img",{id:"pepfar",src:e(g)("login-logos/PEPFAR.png"),alt:"PEPFAR logo",class:"brand-logo-pepfar"},null,8,ae)]),a(e(f),{class:"his-sm-text",slot:"end",lines:"none"},{default:s(()=>[a(e(C),{color:"dark",fill:"outline",size:"large",slot:"end","router-link":"/settings/network"},{default:s(()=>o[3]||(o[3]=[n(" Network ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(e(v),{size:"4",class:"form-section"},{default:s(()=>[a(e(L),{icon:e(j),class:"avatar"},null,8,["icon"]),e(u).name?(w(),H("h3",se,p(e(u).name)+" ("+p(e(u).district)+")",1)):W("",!0),o[5]||(o[5]=l("h4",null,"Please, log into your account",-1)),a(e(f),{style:{margin:"2rem 3.5rem"}},{default:s(()=>[a(e(P),{type:"text",placeholder:"Username",modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=c=>r.value=c),onKeyup:x(d,["enter"]),min:5,required:""},null,8,["modelValue"])]),_:1}),a(e(f),{style:{margin:"2rem 3.5rem"}},{default:s(()=>[a(e(P),{type:"password",modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=c=>t.value=c),placeholder:"Password",onKeyup:x(d,["enter"]),max:100,min:5,required:""},null,8,["modelValue"])]),_:1}),a(e(C),{expand:"full",size:"large",style:{margin:"2rem 3.5rem","text-transform":"none"},onClick:J(d,["prevent"])},{default:s(()=>o[4]||(o[4]=[n(" Login ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const _e=Z(te,[["__scopeId","data-v-05c76410"]]);export{_e as default};
