(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16e1b2a5"],{1276:function(t,e,r){"use strict";var a=r("d784"),n=r("44e7"),o=r("825a"),i=r("1d80"),s=r("4840"),c=r("8aa5"),l=r("50c4"),u=r("14c3"),d=r("9263"),p=r("d039"),f=[].push,v=Math.min,h=4294967295,g=!p((function(){return!RegExp(h,"y")}));a("split",2,(function(t,e,r){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var a=String(i(this)),o=void 0===r?h:r>>>0;if(0===o)return[];if(void 0===t)return[a];if(!n(t))return e.call(a,t,o);var s,c,l,u=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,g=new RegExp(t.source,p+"g");while(s=d.call(g,a)){if(c=g.lastIndex,c>v&&(u.push(a.slice(v,s.index)),s.length>1&&s.index<a.length&&f.apply(u,s.slice(1)),l=s[0].length,v=c,u.length>=o))break;g.lastIndex===s.index&&g.lastIndex++}return v===a.length?!l&&g.test("")||u.push(""):u.push(a.slice(v)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var n=i(this),o=void 0==e?void 0:e[t];return void 0!==o?o.call(e,n,r):a.call(String(n),e,r)},function(t,n){var i=r(a,t,this,n,a!==e);if(i.done)return i.value;var d=o(t),p=String(this),f=s(d,RegExp),b=d.unicode,m=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(g?"y":"g"),w=new f(g?d:"^(?:"+d.source+")",m),y=void 0===n?h:n>>>0;if(0===y)return[];if(0===p.length)return null===u(w,p)?[p]:[];var D=0,S=0,_=[];while(S<p.length){w.lastIndex=g?S:0;var x,C=u(w,g?p:p.slice(S));if(null===C||(x=v(l(w.lastIndex+(g?0:S)),p.length))===D)S=c(p,S,b);else{if(_.push(p.slice(D,S)),_.length===y)return _;for(var k=1;k<=C.length-1;k++)if(_.push(C[k]),_.length===y)return _;S=D=x}}return _.push(p.slice(D)),_}]}),!g)},4632:function(t,e,r){"use strict";var a=r("7949"),n=r.n(a);n.a},5319:function(t,e,r){"use strict";var a=r("d784"),n=r("825a"),o=r("7b0b"),i=r("50c4"),s=r("a691"),c=r("1d80"),l=r("8aa5"),u=r("14c3"),d=Math.max,p=Math.min,f=Math.floor,v=/\$([$&'`]|\d\d?|<[^>]*>)/g,h=/\$([$&'`]|\d\d?)/g,g=function(t){return void 0===t?t:String(t)};a("replace",2,(function(t,e,r,a){var b=a.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,m=a.REPLACE_KEEPS_$0,w=b?"$":"$0";return[function(r,a){var n=c(this),o=void 0==r?void 0:r[t];return void 0!==o?o.call(r,n,a):e.call(String(n),r,a)},function(t,a){if(!b&&m||"string"===typeof a&&-1===a.indexOf(w)){var o=r(e,t,this,a);if(o.done)return o.value}var c=n(t),f=String(this),v="function"===typeof a;v||(a=String(a));var h=c.global;if(h){var D=c.unicode;c.lastIndex=0}var S=[];while(1){var _=u(c,f);if(null===_)break;if(S.push(_),!h)break;var x=String(_[0]);""===x&&(c.lastIndex=l(f,i(c.lastIndex),D))}for(var C="",k=0,O=0;O<S.length;O++){_=S[O];for(var E=String(_[0]),A=d(p(s(_.index),f.length),0),R=[],j=1;j<_.length;j++)R.push(g(_[j]));var P=_.groups;if(v){var I=[E].concat(R,A,f);void 0!==P&&I.push(P);var M=String(a.apply(void 0,I))}else M=y(E,f,A,R,P,a);A>=k&&(C+=f.slice(k,A)+M,k=A+E.length)}return C+f.slice(k)}];function y(t,r,a,n,i,s){var c=a+t.length,l=n.length,u=h;return void 0!==i&&(i=o(i),u=v),e.call(s,u,(function(e,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return r.slice(0,a);case"'":return r.slice(c);case"<":s=i[o.slice(1,-1)];break;default:var u=+o;if(0===u)return e;if(u>l){var d=f(u/10);return 0===d?e:d<=l?void 0===n[d-1]?o.charAt(1):n[d-1]+o.charAt(1):e}s=n[u-1]}return void 0===s?"":s}))}}))},5546:function(t,e,r){},6225:function(t,e,r){"use strict";var a=r("5546"),n=r.n(a);n.a},"76ed":function(t,e,r){},7949:function(t,e,r){},"870a":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"control-container"},[r("div",{staticClass:"row"},[t.isCustom?r("div",{staticClass:"col-2"},[r("date-pick",{staticClass:"date-inputs",attrs:{format:t.format,parseDate:t.parseDate,formatDate:t.formatDate,inputAttributes:{placeholder:"Start Date",readonly:!0}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1):t._e(),t.isCustom?r("div",{staticClass:"col-2"},[r("date-pick",{staticClass:"date-inputs",attrs:{format:t.format,parseDate:t.parseDate,formatDate:t.formatDate,inputAttributes:{placeholder:"End Date",readonly:!0}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1):t._e(),r("div",{staticClass:"col-4"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.qtr,expression:"qtr"}],attrs:{id:"quarters"},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.qtr=e.target.multiple?r:r[0]}}},[r("option",{attrs:{selected:""}},[t._v("Select cohort quarter")]),r("option",[t._v("Custom")]),t._l(t.quarters,(function(e,a){return r("option",{key:a,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])}))],2)]),r("div",{staticClass:"col-4"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-6"},[r("button",{ref:"myid",staticClass:"btn btn-primary",attrs:{id:"submit-btn"},on:{click:function(e){return t.selectQuarter(!1)}}},[t._v(" Archived report ")])]),r("div",{staticClass:"col-6"},[r("button",{ref:"myid",staticClass:"btn btn-danger",attrs:{id:"generate-btn"},on:{click:function(e){return t.selectQuarter(!0)}}},[t._v(" Fresh report ")])])])])])])},n=[],o=r("f0ca"),i=r.n(o),s=(r("6f3c"),r("1789")),c={data:function(){return{quarters:[],startDate:"",endDate:"",format:"YYYY-MM-DD",qtr:"Select cohort quarter"}},computed:{isCustom:function(){return"Custom"===this.qtr}},components:{DatePick:i.a},props:["onSubmit"],methods:{parseDate:function(t,e){return s["a"].parse(t,e)},formatDate:function(t,e){return s["a"].format(t,e)},selectQuarter:function(t){var e=quarters.value?[quarters.value,t,this.startDate,this.endDate]:[];e[2]=this.startDate,e[3]=this.endDate,this.onSubmit(e)},enableBTN:function(){this.$refs.myid.disabled=!1},loadQuarters:function(){var t=[],e="",r=new Date;r=new Date(r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+" 00:00");var a=r.getFullYear();r>=new Date(a+"-01-01 00:00")&&r<=new Date(a+"-03-31 00:00")?e="1 "+a:r>=new Date(a+"-04-01 00:00")&&r<=new Date(a+"-06-30 00:00")?e="2 "+a:r>=new Date(a+"-07-01 00:00")&&r<=new Date(a+"-09-30 00:00")?e="3 "+a:r>=new Date(a+"-10-01 00:00")&&r<=new Date(a+"-12-31 00:00")&&(e="4 "+a);var n=parseInt(e.substring(0,1)),o=0;while(o<5)0==o&&this.addFollowingQ(t,n,a),t.push("Q"+n+" "+a),n=n>0?n-=1:n,a=0==n?a-1:a,n=0==n?n+=4:n,o++;this.quarters=t},addFollowingQ:function(t,e,r){e<4?t.push("Q"+(e+1)+" "+r):t.push("Q1 "+(r+1))}},mounted:function(){this.loadQuarters()}},l=c,u=(r("d7ec"),r("fd65"),r("2877")),d=Object(u["a"])(l,a,n,!1,null,"b7accc12",null);e["a"]=d.exports},"8aa5":function(t,e,r){"use strict";var a=r("6547").charAt;t.exports=function(t,e,r){return e+(r?a(t,e).length:1)}},"8e71":function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-overlay",{attrs:{show:t.hideReport,"no-center":!0,"spinner-type":"grow","spinner-variant":"primary"},scopedSlots:t._u([{key:"overlay",fn:function(){return[r("div",{staticStyle:{display:"block","min-height":"720px",width:"100%","padding-top":"20%"}},[t.reportSelected?t._e():r("h1",[t._v("No Report Selected")]),t.reportSelected?r("b-spinner",{attrs:{type:"grow",variant:"primary"}}):t._e()],1)]},proxy:!0}])},[t._t("default")],2)},n=[],o={name:"report-overlay",props:{reportLoading:{type:Boolean,required:!0},reportSelected:{type:Boolean,default:!0}},computed:{hideReport:function(){return this.reportLoading||!this.reportSelected}}},i=o,s=r("2877"),c=Object(s["a"])(i,a,n,!1,null,null,null);e["a"]=c.exports},9331:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"d-flex",attrs:{id:"wrapper"}},[r("side-bar"),r("div",{attrs:{id:"page-content-wrapper"}},[r("top-nav"),r("div",{staticClass:"cohort"},[r("report-date-picker",{attrs:{onSubmit:t.fetchData}})],1),r("div",{staticStyle:{width:"100%","text-align":"right","margin-top":"25px"}},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.subgroup,expression:"subgroup"}],ref:"subgroup",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.subgroup=e.target.multiple?r:r[0]}}},[r("option",[t._v("Select sub group")]),r("option",{attrs:{value:"General"}},[t._v("General")]),r("option",{attrs:{value:"Children"}},[t._v("Children")]),r("option",{attrs:{value:"Women"}},[t._v("Option B+")])])]),r("report-overlay",{attrs:{reportLoading:t.reportLoading,reportSelected:t.reportSelected}},[r("vue-bootstrap4-table",{attrs:{rows:t.rows,columns:t.columns,config:t.config,"show-loader":t.reportLoading,actions:t.actions},on:{"on-download":t.onDownload}})],1)],1)],1)])},n=[],o=(r("a4d3"),r("99af"),r("4de4"),r("4160"),r("b0c0"),r("e439"),r("dbb4"),r("b64b"),r("d3b7"),r("ac1f"),r("3ca3"),r("5319"),r("1276"),r("159b"),r("ddb0"),r("2b3d"),r("ade3")),i=(r("96cf"),r("1da1")),s=r("8e71"),c=r("870a"),l=r("7c08"),u=r("ebd8"),d=r("2f62"),p=r("12f9"),f=r("c1df"),v=r.n(f),h=r("8051");function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function b(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?g(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var m={name:"reports",components:{ReportOverlay:s["a"],"top-nav":u["a"],"side-bar":l["a"],"report-date-picker":c["a"],VueBootstrap4Table:p["a"]},methods:{redirect:function(){this.$router.push("/moh")},fetchData:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.rows=[],r.prev=1,t){r.next=4;break}return r.abrupt("return");case 4:if(e.reportQtr=t[0],e.regenerateReport=t[1],"Select cohort quarter"!=e.reportQtr){r.next=8;break}return r.abrupt("return");case 8:if("Select sub group"!=e.$refs.subgroup.value){r.next=10;break}return r.abrupt("return");case 10:return e.reportLoading=!0,e.reportSelected=!0,r.next=14,e.fetchSurvivalAnalysisData();case 14:return r.prev=14,e.reportLoading=!1,r.finish(14);case 17:case"end":return r.stop()}}),r,null,[[1,,14,17]])})))()},onDownload:function(){var t=null;this.columns.forEach((function(e){t+='"'.concat(e.label,'",')})),t=t.replace("null",""),this.rows.forEach((function(e){t+="\n",Object.keys(e).forEach((function(r){var a=e[r];Array.isArray(e[r])&&(a=e[r].length),t+='"'.concat(a,'",')}))})),t+="\n",t+="Date Created:  ".concat(v()().format("YYYY-MM-DD:h:m:s")," \n                          e-Mastercard Version : ").concat(sessionStorage.EMCVersion," \n                          API Version ").concat(sessionStorage.APIVersion);for(var e=0;e<34;e++)t+=",";var r=new Blob([t],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(r,exportFilename);else{var a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.setAttribute("download","".concat(this.reportTitle,".csv")),document.body.appendChild(a),a.click(),document.body.removeChild(a)}},fetchSurvivalAnalysisData:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e="cohort_survival_analysis?date="+v()().format("YYYY-MM-DD"),e+="&quarter="+this.reportQtr,e+="&age_group="+this.$refs.subgroup.value+"&program_id=1",1==this.regenerateReport?(this.regenerateReport=!1,e+="&regenerate=true"):e+="&regenerate=false",console.log(e),t.next=7,h["a"].get(e);case 7:if(r=t.sent,200!==r.status){t.next=17;break}return t.t0=this,t.next=12,r.json();case 12:t.t1=t.sent,t.t2=this.$refs.subgroup.value,t.t0.loadData.call(t.t0,t.t1,t.t2),t.next=17;break;case 17:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadData:function(t,e){for(var r in t){r.split(" ")[1];var a=t[r],n=r,o="",i=0,s=0,c=0,l=0,u=0,d=0,p=0;for(var f in a){var v=a[f];for(var h in v)o=h,"On antiretrovirals"==f?i=a[f][h]:"Defaulted"==f?c=a[f][h]:"Patient died"==f?s=a[f][h]:"Stopped"==f?l=a[f][h]:"Patient transferred out"==f?u=a[f][h]:d=a[f][h],p+=a[f][h]}if(p>0)this.rows.push({1:n,2:o,3:e,4:p,"":"",5:i,6:s,7:c,8:l,9:u,10:d})}},addClass:function(t){var e=document.getElementById(t),r=e.getElementsByTagName("td");r[5].setAttribute("class","count-separator")}},data:function(){return{reportQtr:[],regenerateReport:!1,reportData:null,reportID:null,reportLoading:!1,reportSelected:!1,APIVersion:sessionStorage.APIVersion,EMCVersion:sessionStorage.EMCVersion,subgroup:"Select sub group",config:{card_title:"Survival Analysis.",show_refresh_button:!1,show_reset_button:!1},actions:[{btn_text:"CSV",event_name:"on-download",class:"btn btn-primary my-custom-class"}],rows:[],columns:[{label:"Reg Cohort",name:"1",sort:!0},{label:"Interval (Months)",name:"2",sort:!0},{label:"Sub group",name:"3",sort:!0},{label:"Total Reg (database)",name:"4",sort:!0},{label:"Total Reg (confirmed)",name:"5",sort:!0},{label:"Alive",name:"6",sort:!0},{label:"Died",name:"7",sort:!0},{label:"Stopped",name:"8",sort:!0},{label:"Transferred out",name:"9",sort:!0},{label:"Unknown",name:"10"}]}},computed:b({},Object(d["c"])(["location"]),{getSubGroup:function(){},reportTitle:function(){return"MOH ".concat(this.location.name," cohort report (Survival analysis) ").concat(this.subgroup)}}),mounted:function(){}},w=m,y=(r("6225"),r("4632"),r("2877")),D=Object(y["a"])(w,a,n,!1,null,"6b9ccc27",null);e["default"]=D.exports},ac90:function(t,e,r){},d7ec:function(t,e,r){"use strict";var a=r("76ed"),n=r.n(a);n.a},fd65:function(t,e,r){"use strict";var a=r("ac90"),n=r.n(a);n.a}}]);
//# sourceMappingURL=chunk-16e1b2a5.b045ebd7.js.map