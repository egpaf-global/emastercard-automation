(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b66fc"],{"1cc7":function(e,t,i){"use strict";i.r(t);var o=i("7a23");const n=Object(o["createElementVNode"])("br",null,null,-1);function c(e,t,i,c,a,r){const d=Object(o["resolveComponent"])("ion-title"),l=Object(o["resolveComponent"])("ion-toolbar"),s=Object(o["resolveComponent"])("ion-header"),b=Object(o["resolveComponent"])("ion-checkbox"),m=Object(o["resolveComponent"])("ion-label"),h=Object(o["resolveComponent"])("ion-button"),p=Object(o["resolveComponent"])("ion-item"),O=Object(o["resolveComponent"])("ion-list"),j=Object(o["resolveComponent"])("ion-content"),u=Object(o["resolveComponent"])("ion-footer"),C=Object(o["resolveComponent"])("ion-page");return Object(o["openBlock"])(),Object(o["createBlock"])(C,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(s,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(l,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(d,{class:"his-lg-text"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.title),1)]),_:1})]),_:1})]),_:1}),Object(o["createVNode"])(j,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(O,null,{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.items,(t,i)=>(Object(o["openBlock"])(),Object(o["createBlock"])(p,{class:"his-md-text",key:i},{default:Object(o["withCtx"])(()=>[e.ddeEnabled?(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:0,slot:"start",modelValue:t.isChecked,"onUpdate:modelValue":e=>t.isChecked=e},null,8,["modelValue","onUpdate:modelValue"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(m,{color:t.isComplete?"":"danger"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.name)+" ("+Object(o["toDisplayString"])(t.gender)+") "+Object(o["toDisplayString"])(t.birthdate)+" ",1),n,Object(o["createTextVNode"])(" Current District: "),Object(o["createElementVNode"])("b",null,Object(o["toDisplayString"])(t.curDistrict||"Unknown"),1),Object(o["createTextVNode"])(" Home Village: "),Object(o["createElementVNode"])("b",null,Object(o["toDisplayString"])(t.homeVillage||"Unknown"),1)]),_:2},1032,["color"]),Object(o["createVNode"])(h,{size:"medium",onClick:()=>e.reassignIdentifier(t)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(" Re-Assign ")]),_:2},1032,["onClick"]),t.isComplete?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(h,{key:1,size:"medium",color:"warning","router-link":"/patient/registration?edit_person="+t.patientID},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(" Update Missing Data ")]),_:2},1032,["router-link"]))]),_:2},1024))),128))]),_:1})]),_:1}),Object(o["createVNode"])(u,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(l,{color:"dark"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(h,{"router-link":"/",color:"danger",slot:"start",size:"large"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(" Cancel ")]),_:1}),e.itemsChecked.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(h,{key:0,onClick:e.clear,color:"warning",slot:"end",size:"large"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(" Clear ")]),_:1},8,["onClick"])):Object(o["createCommentVNode"])("",!0),e.itemsChecked.length>1?(Object(o["openBlock"])(),Object(o["createBlock"])(h,{key:1,onClick:t[0]||(t[0]=t=>e.onAction(e.mergeSelected,"merge")),color:"primary",size:"large",slot:"end"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(" Merge ("+Object(o["toDisplayString"])(e.itemsChecked.length)+") ",1)]),_:1})):Object(o["createCommentVNode"])("",!0)]),_:1})]),_:1})]),_:1})}i("14d9");var a=i("d867"),r=i("fa73"),d=i("23e6"),l=i("b5e4"),s=i("0fa1"),b=i("9283"),m=Object(o["defineComponent"])({components:{IonPage:a["IonPage"],IonCheckbox:a["IonCheckbox"],IonButton:a["IonButton"],IonList:a["IonList"],IonItem:a["IonItem"],IonToolbar:a["IonToolbar"],IonHeader:a["IonHeader"],IonTitle:a["IonTitle"],IonContent:a["IonContent"],IonFooter:a["IonFooter"]},data:()=>({dde:{},ddeEnabled:!1,items:[],title:"",npid:""}),watch:{$route:{handler({params:e}){e&&(this.npid=e.npid,this.title=`Duplicates for NPID (${this.npid})`,this.init(this.npid))},deep:!0,immediate:!0}},computed:{itemsChecked(){return this.items.filter(e=>e.isChecked)}},methods:{async onAction(e,t="proceed"){const i=await Object(l["a"])(`\n                Are you sure you want to ${t}?\n            `);if(i)try{await e()}catch(o){Object(l["e"])(""+o),console.error(o)}},async mergeSelected(){if(!this.itemsChecked.every(e=>e.isComplete))return Object(l["e"])("One or more patients have missing data. Please update them before merging.",5e3);await this.dde.postMerge(this.itemsChecked)&&(await this.dde.printNpid(this.dde.patientID),Object(s["b"])(this.dde.patientID,this.$router))},async reassignIdentifier(e){if(!e.isComplete&&this.ddeEnabled){const t=await Object(l["a"])("Do you want to update missing information?",{header:"Incomplete Demographics"});if(t){let t="edit_person="+e.patientID;t+="&dde_reassign=true",t+="&doc_id="+e.docID,this.$router.push("/patient/registration?"+t)}}else this.onAction(async()=>{this.ddeEnabled?await this.dde.reassignNpid(e.docID,e.patientID)&&await this.dde.printNpid(e.patientID):"function"===typeof e.assignLocalNpidAndPrint&&await e.assignLocalNpidAndPrint(),Object(s["b"])(e.patientID,this.$router)},"Reassign")},buildItems(e){return e.map(e=>{try{const t=new d["a"](e);return{isChecked:!1,patientID:t.getID(),name:t.getFullName(),gender:t.getGender(),birthdate:b["c"].toStandardHisDisplayFormat(t.getBirthdate()),curDistrict:t.getCurrentDistrict(),homeVillage:t.getHomeVillage(),docID:t.getPatientIdentifier(27),isComplete:t.patientIsComplete(),assignLocalNpidAndPrint:async()=>{await t.assignNpid(),await t.printNationalID()}}}catch(t){Object(l["c"])("An error has occured while building data"),console.error(t)}return{isChecked:!1,patientID:"N/A",name:"N/A",gender:"N/A",birthdate:"N/A",curDistrict:"N/A",homeVillage:"N/A",docID:"N/A",isComplete:!1}})},clear(){this.items=this.items.map(e=>(e.isChecked=!1,e))},async init(e){try{if(this.dde=new r["a"],await this.dde.loadDDEStatus(),this.ddeEnabled=this.dde.isEnabled(),this.ddeEnabled){const{locals:t,remotes:i}=await this.dde.findNpid(e);this.items=[...this.buildItems(t),...this.buildItems(i)]}else{const t=await d["a"].findByNpid(e);t&&(this.items=this.buildItems(t))}}catch(t){Object(l["c"])(""+t,5e3)}}}}),h=i("6b0d"),p=i.n(h);const O=p()(m,[["render",c]]);t["default"]=O}}]);
//# sourceMappingURL=chunk-2d0b66fc.21fa07f6.js.map