(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["TouchFormElement7","TouchFormElement9"],{"05d5":function(e,t,n){"use strict";n.r(t);var c=n("7a23");const a=e=>(Object(c["pushScopeId"])("data-v-4bfb5d52"),e=e(),Object(c["popScopeId"])(),e),o={class:"view-port-content"},l={key:0,class:"his-card history"},i={class:"his-table"},s=a(()=>Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null," Medication"),Object(c["createElementVNode"])("th",null," Date"),Object(c["createElementVNode"])("th",null," Amount dispensed ")],-1)),r={key:1,class:"prescription-tab"},d={class:"prescription-table-section his-card"},b={class:"his-table"},u=a(()=>Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null," Medication"),Object(c["createElementVNode"])("th",null," Amount in stock"),Object(c["createElementVNode"])("th",null," Amount needed"),Object(c["createElementVNode"])("th",null," Amount dispensed "),Object(c["createElementVNode"])("th",null," Reset ")],-1)),m={class:"barcode-section"};function O(e,t,n,a,O,j){const p=Object(c["resolveComponent"])("nav-button"),h=Object(c["resolveComponent"])("ion-col"),V=Object(c["resolveComponent"])("ion-input"),N=Object(c["resolveComponent"])("reset-button"),f=Object(c["resolveComponent"])("barcode"),v=Object(c["resolveComponent"])("ion-row"),E=Object(c["resolveComponent"])("view-port");return Object(c["openBlock"])(),Object(c["createBlock"])(E,null,{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",o,[Object(c["createVNode"])(v,null,{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(h,{size:"2"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(p,{onClick:t[0]||(t[0]=t=>e.tab="prescribe"),isActive:"prescribe"===e.tab,image:"prescription/rx",label:"Prescribed"},null,8,["isActive"]),Object(c["createVNode"])(p,{onClick:t[1]||(t[1]=t=>e.tab="history"),isActive:"history"===e.tab,image:"prescription/history",label:"History"},null,8,["isActive"])]),_:1}),Object(c["createVNode"])(h,{size:"10"},{default:Object(c["withCtx"])(()=>["history"===e.tab?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",l,[Object(c["createElementVNode"])("table",i,[s,(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.medicationHistory,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.medication),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.date),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.amount),1)]))),128))])])):Object(c["createCommentVNode"])("",!0),"prescribe"===e.tab?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",r,[Object(c["createElementVNode"])("div",d,[Object(c["createElementVNode"])("table",b,[u,(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.listData,(t,n)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:n},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.label),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.fmtNumber(t.other.available_stock)),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.other.amount_needed),1),Object(c["createElementVNode"])("td",null,[Object(c["createVNode"])(V,{disabled:t.value>0,value:t.value,onClick:n=>t.value<=0?e.launchDispenser(t):null,class:"dosage-input"},null,8,["disabled","value","onClick"])]),Object(c["createElementVNode"])("td",null,[Object(c["createVNode"])(N,{label:"",disabled:t.value<=0,onClick:n=>t.value>0?e.onReset(t):null},null,8,["disabled","onClick"])])]))),128))])]),Object(c["createElementVNode"])("div",m,[Object(c["createVNode"])(f,{onOnScan:e.onScan,class:"his-card"},null,8,["onOnScan"])])])):Object(c["createCommentVNode"])("",!0)]),_:1})]),_:1})])]),_:1})}n("13d5");var j=n("0a79"),p=n("d867"),h=n("efaf"),V=n("c850"),N=n("7653");const f=e=>(Object(c["pushScopeId"])("data-v-886b899a"),e=e(),Object(c["popScopeId"])(),e),v={colspan:"6"},E=f(()=>Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"Total tab(s) needed "),Object(c["createElementVNode"])("th",{colspan:"2"}," Available stock "),Object(c["createElementVNode"])("th",{colspan:"2"}," Dispensed "),Object(c["createElementVNode"])("th")],-1)),k=f(()=>Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th"),Object(c["createElementVNode"])("th",null," Pack size "),Object(c["createElementVNode"])("th",null," Packs "),Object(c["createElementVNode"])("th",null," Total Tab(s)"),Object(c["createElementVNode"])("th",null," Packs "),Object(c["createElementVNode"])("th")],-1)),y=["rowspan"],C={class:"btn-list"};function g(e,t,n,a,o,l){const i=Object(c["resolveComponent"])("ion-button"),s=Object(c["resolveComponent"])("ion-content"),r=Object(c["resolveComponent"])("ion-toolbar"),d=Object(c["resolveComponent"])("ion-footer");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createVNode"])(s,null,{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("table",null,[Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",v,Object(c["toDisplayString"])(e.drugName),1)]),E,k]),Object(c["createElementVNode"])("tbody",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("td",{rowspan:e.amountNeededRowSpan},Object(c["toDisplayString"])(e.tabsNeeded)+" tab(s) ",9,y)]),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.listData,(t,n)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:n},[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t,(t,n)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("td",{key:n,class:Object(c["normalizeClass"])(n>=2?"input-field":"his-md-text")},Object(c["toDisplayString"])(e.fmtNumber(t)),3))),128)),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("ul",C,[Object(c["createElementVNode"])("li",null,[Object(c["createVNode"])(i,{onClick:t=>e.incrementAmount(n),class:"dispense-btn",size:"large"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(" + ")]),_:2},1032,["onClick"])]),Object(c["createElementVNode"])("li",null,[Object(c["createVNode"])(i,{onClick:t=>e.decrementAmount(n),class:"dispense-btn",size:"large"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(" - ")]),_:2},1032,["onClick"])])])])]))),128))])])]),_:1}),Object(c["createVNode"])(d,null,{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(r,null,{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(i,{onClick:e.onClose,color:"danger",size:"large",slot:"end"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(" Close ")]),_:1},8,["onClick"]),Object(c["createVNode"])(i,{onClick:t[0]||(t[0]=t=>e.onDispense(e.dispensedValues)),color:"success",size:"large",slot:"end"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(" Dispense ")]),_:1})]),_:1})]),_:1})],64)}var w=n("0011"),D=Object(c["defineComponent"])({data:()=>({listData:[],tabsIndex:2,packsIndex:3}),props:{drugName:{type:String,required:!0},tabsNeeded:{type:String,required:!0},items:{type:Array,required:!0},onDispense:{type:Function,required:!0}},computed:{dispensedValues(){return this.listData.filter(e=>e[this.tabsIndex]>0).map(e=>[e[this.tabsIndex],e[this.packsIndex]])},amountNeededRowSpan(){return this.listData.length+1}},watch:{items:{handler(e){e&&(this.listData=[...e])},deep:!0,immediate:!0}},methods:{async onClose(){await p["modalController"].dismiss({})},incrementAmount(e){const[t,,n,c]=this.listData[e],a=t+n,o=c+1;this.listData[e][2]=a,this.listData[e][3]=o},decrementAmount(e){const[t,,n,c]=this.listData[e],a=c-1;if(a>=0){const c=n-t;this.listData[e][2]=c,this.listData[e][3]=a}},fmtNumber(e){return/-/i.test(e)?e:Object(w["j"])(e)}}}),B=(n("c035"),n("6b0d")),S=n.n(B);const _=S()(D,[["render",g],["__scopeId","data-v-886b899a"]]);var x=_,I=n("51c8"),A=n("2ef0"),F=n("b5e4"),z=Object(c["defineComponent"])({components:{ViewPort:j["a"],Barcode:h["a"],NavButton:V["a"],ResetButton:N["a"],IonRow:p["IonRow"],IonCol:p["IonCol"]},mixins:[I["default"]],data:()=>({tab:"prescribe",listData:[],medicationHistory:[],isStockManagementEnabled:!1}),mounted(){this.init()},activated(){this.init()},watch:{tab:{handler(e){"history"===e&&Object(A["isEmpty"])(this.medicationHistory)&&"function"===typeof this.config.medicationHistory&&this.config.medicationHistory().then(e=>{e&&(this.medicationHistory=e)}).catch(e=>{Object(F["c"])(""+e)})}}},methods:{async init(){var e,t;(this.$emit("onFieldActivated",this),"function"===typeof(null===(e=this.config)||void 0===e?void 0:e.isDrugManagementEnabled))&&(this.isStockManagementEnabled=null===(t=this.config)||void 0===t?void 0:t.isDrugManagementEnabled());this.listData=await this.options(this.fdata)},async onScan(e){const[t,n]=e.split("-"),c=this.listData.map(async e=>{if(e.other.drug_id===parseInt(t)){const t=parseInt(e.value.toString()),c=parseInt(n),a=await this.updateOnValue(e,c,[],!0);a&&(e.value=c+t)}return e});this.listData=await Promise.all(c)},async onReset(e){await this.updateOnValue(e,-1)},fmtNumber(e){return!this.isStockManagementEnabled||/-/i.test(e)?"-":Object(w["j"])(e)},async updateOnValue(e,t,n=[],c=!1){if(this.onValue){const a=await this.onValue({label:e.label,other:{dispenses:n,...e.other},value:t},c);if(!a)return!1}return e.value=t<0?0:t,this.$emit("onValue",e),this.onValueUpdate&&(this.listData=await this.onValueUpdate(e,this.listData)),!0},async launchDispenser(e){const t=await p["modalController"].create({component:x,backdropDismiss:!1,cssClass:"custom-modal",componentProps:{drugName:e.label,tabsNeeded:e.other.amount_needed,items:e.other.pack_sizes,onDispense:async t=>{const n=0,c=t.reduce((e,t)=>e+t[n],0),a=await this.updateOnValue(e,c,t);a&&await p["modalController"].dismiss({})}}});t.present()}}});n("ac0d");const q=S()(z,[["render",O],["__scopeId","data-v-4bfb5d52"]]);t["default"]=q},"0a79":function(e,t,n){"use strict";var c=n("7a23");function a(e,t,n,a,o,l){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{id:"view-port",class:Object(c["normalizeClass"])(e.showFull?"":"half")},[Object(c["renderSlot"])(e.$slots,"default",{},void 0,!0)],2)}var o=Object(c["defineComponent"])({name:"ViewPort",props:{showFull:{type:Boolean,default:()=>!0}}}),l=(n("a4d3"),n("6b0d")),i=n.n(l);const s=i()(o,[["render",a],["__scopeId","data-v-7c293cad"]]);t["a"]=s},"2ee9":function(e,t,n){"use strict";n("beb6")},"51c8":function(e,t,n){"use strict";n.r(t);var c=n("7a23"),a=Object(c["defineComponent"])({emits:["onValue","onFieldActivated"],props:{config:{type:Object,default:()=>({})},preset:{type:Object,default:()=>({label:"",value:""})},defaultValue:{type:Function},fdata:{type:Object,required:!0},cdata:{type:Object,required:!0},clear:{type:Number,required:!0},options:{type:Function,default:()=>[]},activationState:{type:String,default:""},onValue:{type:Function},onValueUpdate:{type:Function},footerButtonEvent:{type:Object}}});const o=a;t["default"]=o},7653:function(e,t,n){"use strict";var c=n("7a23");const a=["src"];function o(e,t,n,o,l,i){const s=Object(c["resolveComponent"])("center");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{class:Object(c["normalizeClass"])(e.state)},[Object(c["createVNode"])(s,null,{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("img",{src:e.icon},null,8,a)]),_:1})],2)}var l=Object(c["defineComponent"])({props:{label:{type:String,required:!0},disabled:{type:Boolean}},computed:{state(){return this.disabled?"disabled-btn":"clickable"},icon(){return"assets/images/reset.png"}}}),i=(n("de49"),n("6b0d")),s=n.n(i);const r=s()(l,[["render",o],["__scopeId","data-v-7970cd10"]]);t["a"]=r},"9faa":function(e,t,n){},a4d3:function(e,t,n){"use strict";n("a6f7")},a6f7:function(e,t,n){},ac0d:function(e,t,n){"use strict";n("cd46")},beb6:function(e,t,n){},c035:function(e,t,n){"use strict";n("9faa")},c850:function(e,t,n){"use strict";var c=n("7a23");const a=["src"];function o(e,t,n,o,l,i){const s=Object(c["resolveComponent"])("center");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{class:Object(c["normalizeClass"])(`his-card ${e.state} clickable`)},[Object(c["createElementVNode"])("img",{src:e.icon},null,8,a),Object(c["createVNode"])(s,null,{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.label),1)]),_:1})],2)}var l=Object(c["defineComponent"])({props:{label:{type:String,required:!0},image:{type:String,required:!0},isActive:{type:Boolean,default:!0}},computed:{state(){return this.isActive?"active-card-color":"disabled-card-color"},icon(){return`assets/images/${this.image}.png`}}}),i=(n("2ee9"),n("6b0d")),s=n.n(i);const r=s()(l,[["render",o],["__scopeId","data-v-321424f0"]]);t["a"]=r},cd46:function(e,t,n){},de49:function(e,t,n){"use strict";n("ee38")},ee38:function(e,t,n){}}]);
//# sourceMappingURL=TouchFormElement7.efa2a3d5.js.map