{"version":3,"sources":["webpack:///./src/views/Users/edit.vue?33ab","webpack:///src/views/Users/edit.vue","webpack:///./src/views/Users/edit.vue?317f","webpack:///./src/views/Users/edit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","loading","user","on","editUser","staticRenderFns","components","created","loadUser","computed","userId","$route","params","data","methods","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,WAAW,CAACA,EAAG,eAAe,CAACE,MAAM,CAAC,QAAUN,EAAIO,QAAQ,KAAOP,EAAIQ,KAAK,UAAW,EAAK,WAAa,eAAeC,GAAG,CAAC,YAAYT,EAAIU,aAAa,IACxPC,EAAkB,G,oFCetB,GACEC,WAAY,CAAd,qCACEC,QAFF,WAGIZ,KAAKa,YAEPC,SAAU,CACRC,OADJ,WAEM,OAAOf,KAAKgB,OAAOC,OAAO,YAG9BC,KAVF,WAWI,MAAO,CACLX,KAAM,GACND,SAAS,IAGba,QAAS,CACP,SADJ,SACA,yLAEA,aACA,eAHA,eAGA,EAHA,cAIA,gBACA,iBALA,SAQA,+CARA,UAQA,EARA,OAUA,eAVA,kCAWA,SAXA,wBAWA,EAXA,EAWA,OACA,kGAZA,2BAgBA,mCAhBA,yBAkBA,aAlBA,8EAqBI,UAtBJ,WAsBA,8KACA,uCADA,UACA,EADA,OAGA,eAHA,uBAIA,gGAJA,kBAKA,MALA,UAMA,eANA,wBAOA,sDAPA,kBAQA,MARA,iCAUA,UAVA,+CAaI,SAnCJ,WAmCA,uKACA,aADA,SAGA,cAHA,OAGA,EAHA,OAIA,oBAEA,QACA,kBACA,oBACA,2BACA,6BACA,eAGA,aAdA,gDCnE6V,I,YCOzVC,EAAY,eACd,EACAtB,EACAY,GACA,EACA,KACA,KACA,MAIa,aAAAU,E","file":"js/chunk-2d210a2b.2d79d869.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('PageView',[_c('UserEditForm',{attrs:{\"loading\":_vm.loading,\"user\":_vm.user,\"editMode\":true,\"submitText\":\"Update user\"},on:{\"on-submit\":_vm.editUser}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <PageView>\n    <UserEditForm :loading=\"loading\"\n                  @on-submit=\"editUser\"\n                  :user=\"user\"\n                  :editMode=\"true\"\n                  submitText=\"Update user\" />\n  </PageView>\n</template>\n\n<script>\nimport ApiClient from \"@/services/api_client\";\n\nimport PageView from \"@/components/PageView\";\nimport UserEditForm from \"@/components/users/UserEditForm\"\n\nexport default {\n  components: {PageView, UserEditForm},\n  created() {\n    this.loadUser();\n  },\n  computed: {\n    userId() {\n      return this.$route.params['userId'];\n    }\n  },\n  data() {\n    return {\n      user: {},\n      loading: true\n    }\n  },\n  methods: {\n    async editUser(user) {\n      try {\n        this.loading = true;\n        const {password, ...params} = user;\n        if (password && password.length > 0) {\n          params['password'] = password\n        }\n\n        const response = await ApiClient.put(`/users/${this.user.user_id}`, params); \n\n        if (response.status !== 200) {\n          const {errors} = await response.json();\n          this.$vbToast.toast(`Failed to update user: ${errors.join(', ')}`, {title: 'Error', variant: 'danger'});\n          return;\n        }\n\n        this.$router.push({name: 'ListUsers'});\n      } finally {\n        this.loading = false;\n      }\n    },\n    async fetchUser() {\n      const response = await ApiClient.get(`/users/${this.userId}`);\n\n      if (response.status === 404) {\n        this.$router.push({name: 'NotFoundError', params: {message: `User #${this.userId} not found!`}});\n        return null;\n      } else if (response.status !== 200) {\n        alert(`Unexpected error occurred: ${response.status}`);\n        return null;\n      } else {\n        return response.json();\n      }\n    },\n    async loadUser() {\n      this.loading = true;\n\n      const user = await this.fetchUser();\n      const name = user.person.names[0];\n\n      this.user = {\n        user_id: user.user_id,\n        username: user.username,\n        given_name: name && name.given_name,\n        family_name: name && name.family_name,\n        roles: user.roles\n      };\n\n      this.loading = false;\n    }\n  }\n}\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./edit.vue?vue&type=template&id=7e875374&\"\nimport script from \"./edit.vue?vue&type=script&lang=js&\"\nexport * from \"./edit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}